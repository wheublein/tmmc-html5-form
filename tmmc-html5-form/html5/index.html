<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>The Marine Mammal Center 2018 v1.0
  </title>
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">

<!-- <link rel="stylesheet" type="text/css" href="css/input.css" /> -->
<!-- target resolution 2048 x 1536 retina ipad -->

<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

<script>
    <!-- //sound that plays when buttons are clicked -->
    function playSound() {
          var sound = document.getElementById("audio");
          sound.play();
      }
</script>

<style>

 body{
    max-width: 1600px;
    font-size: 18px;
    letter-spacing: 1px;
   -webkit-font-smoothing: antialiased;
   -moz-osx-font-smoothing: grayscale;
  }

 div{max-width: 1600px}
 
 img{max-width:100%; max-height:800px}

 #background-image-holder{
     max-height:500px;
     overflow:hidden;
}

 #button-left-holder{
    float:left;
    width:48%;
    text-align: center;
}

 #button-right-holder{
    float:left;
    width:48%;
    text-align: center;
}

#popupDonate{
  font-size: 24px;
  letter-spacing: 0px;
}

.hideme{
  
   display: none; 
  
}

h1{
  line-height: 0.8em;
  padding-bottom:.4em !important;
}

h2{
  font-size:1.8em;
  font-weight: normal;
  line-height: 1.4em;
  letter-spacing: 1px;
  padding:0px;
  margin:0px;
  margin-top:-10px;
  color:#1c89ab;
  color:#5cbddd;
  -webkit-margin-before: 0em !important;
  -webkit-margin-after: 0em !important;
}

h3{
  font-size:1.2em;
  font-weight: normal;
  line-height: 1.2em;
  padding:10px;
  margin:0px;
  max-width: 96%;
}

h4{
  font-size:1em;
  font-style: italic;
  font-weight: normal;
  color:#CCC;
  line-height: 1em;
  padding:4px 10px;
  margin:0px;
}

.input-holder{
  max-width:600px;
  margin-left: 0px
}

.input-label-content{
  padding-left:20px;
  color:#F00;
  color:#1c89ab;
}

.column {
    float: left;
}

.leftcol {
    float:left;
    width: 50%;
    border:2px solid #F00;
}

.rightcol {
  position:absolute;
  right:100px;
  top:100px;
  border:2px solid #F0F;
}

.top-right {
  position:absolute;
  right:10px;
  top:60px;
}

.bottom-right {
  position:absolute;
  right:10px;
  bottom:180px;
}

.bottom-center{
  padding-top:40px;  
  padding-bottom:100px;
}

#bgImage{
  height:600px;
  max-height:600px;
}

#thanks-page{
  margin-left:20px;
 padding-left:20px;   
}

#thanks-text{
  max-width:70%;
}


form{
  border:2px solid #111;
  border-radius: 20px;
  padding:10px;
  margin:20px;
  margin-left:6px;
  background-color:#222;
}

</style>

</head>

<body>

<audio id="audio" src="../sounds/alternate-click.wav"  autostart="false" ></audio>

<div data-role="page" id="frontpage" data-theme="b">
    <div data-role="header">
        <h1>The Marine Mammal Center</h1>
    </div>

<div id="background-image-holder">
<!-- <img id="bgImage" src="assets/mmc_seal_2_2048x1600.jpg" alt="Seal rescued by TMMC" /> -->
    <img id="bgImage" src="assets/mmc_seal_2_1200x700.jpg" alt="Seal rescued by TMMC" />
  
</div>

  <div data-role="main" class="ui-content center">

  <div class="hideme">
    Background Time left is <span id="bgTimeDisplay">360</span> seconds.
</div>

<div id="button-holder">
    <div id="button-left-holder">
<img src="assets/button_give_rectangle_200.png" class="resized-image" id="give" alt="donate button"/><br />
       Make a Donation
</div>

<div id="button-right-holder">

   <a href="#backpage" data-transition="flip"  data-shadow="false" data-theme="none" id="forward-btn">
    <img src="assets/button_mail_rectangle_200.png" class="resized-image" id="mail" alt="mailing list button"/><br />
  </a>
       Join Mailing List
</div>

</div>

<div data-role="popup" id="popupDonate" data-theme="a" style="max-width:640px" class="ui-corner-all" data-dismissible="false" data-overlay-theme="b">
        <div style="padding:10px">
            <h3>The Marine Mammal Center uses the Square payment processing system for donations made by credit or debit card - a volunteer can help you complete your donation.</h3>
            <div class="hideme">
             Popup time left is <span id="popupGiveTimeDisplay">10</span> seconds. 
            </div>
            <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-b center" style="max-width:240px" onclick="playSound()" data-rel="back">OK</a>
            <!--  //close alert after 10 seconds -->
        </div>
</div>
</div> 
</div>

<div data-role="page" id="backpage"  data-theme="b">
    <div data-role="header" class="headerbar">
        <h1>TMMC Newsletter Sign Up</h1>
    </div>

    <div data-role="content" id="thanks-text">
      <h2>Keep in Touch</h2>
      <h3>Just fill in the simple form below to be added to The Marine Mammal Center's e-communications list.</h3>
      <h3>You'll get patient stories, latest research insights, retail offers, event invites and more!</h3>
<!--      <h3>Please provide your name and email address below:</h3> -->
      <div class="top-right">
        <img id="topImage" src="assets/enews-smaller.png" alt="Small Image of TMMC Newsletter" />
      </div>

      <section class="input-holder color-4">

      <div id="formMessages"></div>

      <form id="ajax-contact" method="post" action="mailer.php" autocomplete="off">
          
          <div class="field">
            <label for="firstname">First Name:</label>
            <input type="text" id="firstname" name="firstname" maxlength="24" required>
          </div>
          <div class="field">
            <label for="lastname">Last Name:</label>
            <input type="text" id="lastname" name="lastname" maxlength="24" required>
          </div>

          <div class="field">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" maxlength="40" required>
          </div>
          <!--
          <div class="field">
            <label for="message">Message:</label>
            <textarea id="message" name="message"></textarea>
          </div>
          -->
          <div class="field">
            <button id="submit-button" type="submit">Sign Me Up</button>
          </div>
        </form>
    
      </section>

      <h4>* Required field</h4>
      <h4>The Center will not share or exchange your e-mail address.</h4>
      <h4>You may unsubscribe at any time.</h4>

  <div class="bottom-right">
        <img id="bottomImage" src="assets/seal-smaller.png" alt="Small Image of seal" />
      </div>

       <br />
       <a href="#frontpage" data-transition="flip" class="ui-btn ui-corner-all ui-shadow ui-btn-a center" id="backButton" style="max-width:240px">Go to home page</a>

      <div class="hideme">
       <a href="#" data-transition="flip" class="ui-btn ui-corner-all ui-shadow ui-btn-a center" id="testButton" style="max-width:240px">Popup Test</a>
      </div>   
      <div class="hideme">
        <br />
       Signup Time left is <span id="signupTimeDisplay">30</span> seconds. 
      </div>

    <div data-role="popup" id="popupMail" data-theme="a" style="max-width:640px" class="ui-corner-all" data-dismissible="false" data-overlay-theme="b">
            <div style="padding:10px 20px;">
                <h3>This form has been open for a while. This app will go back to the home page unless you need more time to complete the form.</h3>
            
                Time left is <span id="formTimeDisplay">10</span> seconds. 
            
                <a href="#" id='moreTimeButton' class="ui-btn ui-corner-all ui-shadow ui-btn-b center" style="max-width:240px">I need more time</a>
               <a href="#frontpage" data-transition="flip" class="ui-btn ui-corner-all ui-shadow ui-btn-a center" id="mailPopupToHomeButton" style="max-width:240px">Go to home page</a>
            </div>
    </div>
</div>
</div>

<div data-role="page" id="thankspage"  data-theme="b">
    <div data-role="header" class="headerbar">
        <h1>TMMC Thank You</h1>
    </div>
    <div data-role="content" id="thanks-page">
      <h2>Thank You!</h2>
      <h3>See you soon!</h3>
      <h3>The Marine Mammal Center</h3>

      <div class="bottom-center">
        <img id="bottomCenterImage" src="assets/seal-thanks.jpg" alt="Small Image of seal" />
      </div>
     <div class="hideme">
      This page will close in <span id="thanksTimeDisplay">10</span> seconds. 
    </div>
      <a href="#frontpage" data-transition="flip" class="ui-btn ui-corner-all ui-shadow ui-btn-a center" id="mailToHomeButton" style="max-width:240px">Go to home page</a>

      <!-- seal image -->
    </div>
</div>

</body>


<script>
 $("#forward-btn").click(function(){
     playSound();
 });

  $("#mailToHomeButton").click(function(){
     playSound();
 });

  $("#mailPopupToHomeButton").click(function(){
     playSound();
 });

</script>

<!--
  issues:
  
  1. timer doesnt reset on thanks page
  2. no click on thanks page
-->

<script type="text/javascript">
  window.onload = function(){
    //Initial values
    var _popupGiveTimeRemaining = 100;
    var _popupMailTimeRemaining = 100;
    var _backgroundTimeRemaining = 360;
    var _signupTimeRemaining = 360;
    var _thanksTimeRemaining = 3;

    var popupGiveTimeRemaining = _popupGiveTimeRemaining;
    var popupMailTimeRemaining = _popupMailTimeRemaining;

    var backgroundTimeRemaining = _backgroundTimeRemaining;
    var signupTimeRemaining = _signupTimeRemaining;
    var thanksTimeRemaining = _thanksTimeRemaining;

    var isPopupGiveVisible = 0;
    var isPopupMailVisible = 0;


  //Step 3 - Write Some Form Validation
    $('.error').hide();

    
    setInterval(function(){

      currentPage = $('body').pagecontainer( 'getActivePage' ).attr( 'id' );
      // update intervals
      //console.log("Current Page : ");
      //console.log(currentPage);

      //console.log(" isPopupGiveVisible value: ");
      //console.log(isPopupGiveVisible);

      if (currentPage == "frontpage"){
          backgroundTimeRemaining--;
          //console.log("front working");
      };

      if (currentPage == "backpage"){
          //popupTimeRemaining--;
          signupTimeRemaining--;
          //console.log("back working");
      };

     if (currentPage == "thankspage"){
        thanksTimeRemaining--;
        //console.log("thanks working");
      };

     if (isPopupGiveVisible > 0){
        popupGiveTimeRemaining--;
      };

      if (isPopupMailVisible > 0){
        popupMailTimeRemaining--;
      };
      

    // update timers - disable this for release version
    if (currentPage == "frontpage"){
      currentspan = document.getElementById("bgTimeDisplay")
      currentspan.innerHTML = backgroundTimeRemaining;
      if (isPopupGiveVisible > 0){
        currentspan = document.getElementById("popupGiveTimeDisplay")
        currentspan.innerHTML = popupGiveTimeRemaining;
      };
    };
    
    if (currentPage == "backpage"){
      currentspan = document.getElementById("signupTimeDisplay")
      currentspan.innerHTML = signupTimeRemaining;
    };

    if (currentPage == "thankspage"){
      currentspan = document.getElementById("thanksTimeDisplay")
      currentspan.innerHTML = thanksTimeRemaining;
    };

    if (isPopupMailVisible > 0){
      currentspan = document.getElementById("formTimeDisplay")
      currentspan.innerHTML = signupTimeRemaining;
    };

    // update conditionals
    if (currentPage == "frontpage"){
      if (backgroundTimeRemaining === 0){
        backgroundTimeRemaining = _backgroundTimeRemaining;
        myspan = document.getElementById("bgImage").src;
        myimage = myspan.split("/").slice(-1)[0];
        if (myimage === "mmc_seal_1_1200x700.jpg"){document.getElementById("bgImage").src="assets/mmc_seal_2_1200x700.jpg";};
        if (myimage === "mmc_seal_2_1200x700.jpg"){document.getElementById("bgImage").src="assets/mmc_seal_3_1200x700.jpg";};
        if (myimage === "mmc_seal_3_1200x700.jpg"){document.getElementById("bgImage").src="assets/mmc_seal_1_1200x700.jpg";}; 
      };
      if ((isPopupGiveVisible > 0) && (popupGiveTimeRemaining < 0)){
        //hide popup;
        $( "#popupDonate" ).popup( "close",  {transition: "pop"}  );
        popupGiveTimeRemaining = _popupGiveTimeRemaining;
      };
    };

    if (currentPage == "backpage"){
      if (signupTimeRemaining < 1){
        //on backpage, timed out, switch to front page //clear form data
        $('body').pagecontainer( 'change', '#frontpage' );
        signupTimeRemaining = _signupTimeRemaining;
        $('#ajax-contact')[0].reset();
      };
      if ((isPopupMailVisible < 1) && (signupTimeRemaining < 11)){
        //low time - show popup warning
         isPopupMailVisible = 1;
         $( "#popupMail" ).popup( "open",  {transition: "pop"}  );
      } else if ((isPopupMailVisible > 0) && (popupMailTimeRemaining < 0)){
        //hide popup;
          console.log("line 446 hiding popup ");
        $( "#popupDonate" ).popup( "close",  {transition: "pop"}  );
        isPopupMailVisible = 0;
        popupMailTimeRemaining = _popupMailTimeRemaining;
      };
    };

    if (currentPage == "thankspage"){
      if (thanksTimeRemaining < 1){
        //on thanks page, timed out, switch to front page //clear form data
        $('body').pagecontainer( 'change', '#frontpage' );
        thanksTimeRemaining = _thanksTimeRemaining;
        $('#ajax-contact')[0].reset();
      };
    };
    }, 1000);

    $("#give").click(function(){
        playSound();
        popupGiveTimeRemaining = _popupGiveTimeRemaining;
        isPopupGiveVisible = 1;
        $( "#popupDonate" ).popup( "open",  {transition: "pop"}  );
       // what you wanted your button to do when user clicks it    
    });

     $("#mail").click(function(){
        playSound();
        $('#ajax-contact')[0].reset();
        $(formMessages).removeClass('error');
        $(formMessages).removeClass('success');
      });

     $("#backButton").click(function(){
        //back to home page from signup page
        playSound();
        $('#ajax-contact')[0].reset();
        $(formMessages).removeClass('error');
        $(formMessages).removeClass('success');
      });


     $("#testButton").click(function(){
        playSound();
        isPopupMailVisible = 1;
        $( "#popupMail" ).popup( "open",  {transition: "pop"}  );
      });

    $("#moreTimeButton").click(function(){
        playSound();
        popupMailTimeRemaining = _popupMailTimeRemaining;
        signupTimeRemaining = _signupTimeRemaining;
        
        currentSpan = document.getElementById("formTimeDisplay")
        currentSpan.innerHTML = signupTimeRemaining;
        currentSpan = document.getElementById("signupTimeDisplay")
        currentSpan.innerHTML = signupTimeRemaining;
        $( "#popupMail" ).popup( "close",  {transition: "pop"}  );
    });

    $("#mailPopupToHomeButton").click(function(){
      //reset signupTimeRemaining;
      signupTimeRemaining = _signupTimeRemaining;
    });

    $("#submitFormButton").click(function() {
      playSound();
    });

  }
  </script>
  <script src="app.js"></script>
  
</html>

